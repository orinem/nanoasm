*  DISPLAY ROUTINE:*:*:*
  STR R1,0 *CLEAR REGISTER 1
READ STR R0,0 *CLEAR R0
 SFS FLAG0 *SKIP IF DC0 IS SET
 JMP DISPA *DISPLAY MESSAGE A
 SFS FLAG1 *SKIP IF DC1 iS SET
 JMP DISPB *DISPLAY MESSAGE B
 ENI *ENABLE THE INTERRUPT
 JMP READ *BOTH FLAGS ARE CLEAR
DISPA STR R0,40 *REG0=40
 LDA R1 *LOAD ACC FROM POINTER
 SLT *SKIP IF ACC < 40
 STR 1,0 *CLEAR THE POINTER
 ENI : JMP READ
DISPB STR R0,40 *REG0=40
 LDA R1 *LOAD ACC FROM POINTER
 SGE *SKIP IF ACC >= 40
 STR R1,40 *POINTER=40
 ENI: JMP READ
 ORG 377 *INTERRUPT ROUTINE
 STA R2 *STORE THE ACC DURING
* THE INTERRUPT PERIOD:*
 LDA R1 *LOAD ACC FROM POINTER
 OTA DS0 *OUT ACC TO ADDRESS
*LATCH (DEVICE SELECT 0):*:*
 JAI 2 *JUMP INDIRECT TO LOC.
*010, AND 8 BITS OF ACC
BL OTR DS2,40 *OUTPUT BLANK
 JMP DISP
A OTR DS2,101 *OUTPUT 'A' CODE
 JMP DISP
D OTR DS2,104 *OUTPUT 'D' CODE
 JMP DISP
E OTR DS2,105 *OUTPUT 'E' CODE
 JMP DISP
I OTR DS2,111 *OUTPUT 'I' CODE
 JMP DISP
K OTR DS2,113 *OUTPUT 'K' CODE
 JMP DISP
L OTR 2,114 *OUTPUT L: JMP DISP
N OTR 2,115 *OUTPUT N: JMP DISP
O OTR 2,117 *OUTPUT O: JMP DISP
P OTR 2,120 *OUTPUT P: JMP DISP
R OTR 2,122 *OUTPUT R: JMP DISP
S OTR 2,123 *OUTPUT S: JMP DISP
Y OTR 2,131 *OUTPUT Y: JMP DISP
DISP OTR DS1,40 *OUTPUT CODE
* FOR BLANK TO DEVICE 1:*
 OTA DS3 *START THE DISPLAY
 INB
 INB *DOUBLE INCREMENT THE 
* POINTER:*:*
 STA 1: LDA 2 *RELOAD THE ACC
 *BY ITS VALUE BEFORE THE 
 *INTERRUPT OCCURRED:*:*
MIDD ENI *ENABLE THE INTERRUPT
* BEFORE RETURN
 RTI
RESETA STR R1,40 *RESET POINTER
 JMP MIDD
RESETB STR R1,40 *RESET POINTER
 JMP MIDD
 ORG 1000 *DISPLAY:*:*
* DISPLAY IS OK:*:*
 JMP BL *DISPLAY BLANK
 JMP D *DISPLAY D
 JMP I *DISPLAY I
 JMP S *DISPLAY S
 JMP P: JMP L: JMP A: JMP Y
 JMP BL: JMP I: JMP S: JMP BL
 JMP O: JMP K: JMP RESETA
 ORG 1040 *DISPLAY:*:*
* ERROR IN DISPLAY:*:*
 JMP E: JMP R: JMP R
 JMP O: JMP R: JMP BL: JMP I
 JMP N: JMP BL: JMP D: JMP I
 JMP S: JMP P: JMP L: JMP A
 JMP Y: JMP RESETB
R0 OCT 0:R1 OCT 1:R2 OCT 2
DS0 OCT 0: DS1 OCT 1
DS2 OCT 2: DS3 OCT 3
FLAG0 OCT 0:FLAG1 OCT 1: END

